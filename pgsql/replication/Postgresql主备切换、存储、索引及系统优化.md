# 0 Postgresql存储、索引及系统优化、主备切换

## 1 Postgresql存储

### 1.1 物理存储结构

Postgresql当前不支持使用裸设备或者块设备，必须基于文件系统来存储。

#### 1.1.1 关键概念

- Realation：表示表或索引。
- Tuple：表示表中的行。
- Page：表示在磁盘中的数据块。
- Buffer：表示在内存中的数据块

#### 1.1.2 数据块结构

数据块是多行数据的存储结构。

数据块的大小默认是8KB,最大是32KB，一个数据块里存储了多行数据，其数据存储方式采用两头向中间靠拢的方式。
最前面是块头，块头后面记录了各个数据行的指针，数据行从块尾向中间排列，直到和行指针相遇（即没有空间存放新的行数据）。
行数据指针与行数据之间的部分就是空闲空间。

- 块头
- 行指针
- 行数据

#### 1.1.3 tuple结构

## 2 Postgresql索引

## 3 Postgresql系统优化

## 4 Postgresql主备切换